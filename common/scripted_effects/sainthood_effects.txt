become_saint = {
	save_scope_as = new_saint

	faith = {
		add_to_variable_list = {
			name = faith_saints
			target = scope:new_saint
		}
	}

	dynasty ?= {
		add_dynasty_modifier = {
			modifier = saintly_bloodline
			# Why even bother at this point?
		}
		every_dynasty_member = {
			limit = { is_alive = yes }
			add_piety = 300
		}
		add_dynasty_prestige_level = 1 # Why was this placed outside the dynasty scope??
	}

	#Create a blank Saint Day
	
	if = {
		limit = {
			exists = scope:saint_capital_province #safety check
		}
		create_character = {
			location = scope:saint_capital_province
			gender = male
			age = { 16 50 }
			trait = education_learning_2
			trait = devoted
			faith = root.faith
			culture = scope:saint_capital_province.culture
			learning = { 10 12 }
			save_scope_as = saint_day_holder
		}

		faith = { #debug
			add_to_variable_list = {
				name = faith_saint_day_holders
				target = scope:saint_day_holder
			}
			#set_variable = {
			#	name = recent_denomination
			#	value = yes
			#	years = 20
			#}
		}

		scope:saint_day_holder = {
			#add_gold = 10
			#add_prestige = 10
			set_variable = {
				name = saint_day_saint
				value = scope:saint_person
			}
			set_variable = {
				name = saint_day_saint_tomb_location
				value = scope:saint_capital_province
			}
			create_story = story_saint_day
			#trigger notification for liege: A Monk has arrived!
		}
	}
}

#become_saint_debug = {
#	remove_trait = beatified
#	add_trait = saint	
#	become_saint = yes
#	
#
#	capital_province = {
#		add_province_modifier = saintly_tomb	
#	}
#
#	capital_province.county = {
#		add_to_variable_list = {
#			name = faith_saints_and_capital
#			target = root
#		}
#	}
#
#	faith = {
#		add_to_variable_list = {
#			name = faith_capital
#			target = root.capital_province.county
#		}
#	}
#
#	#Create a blank Saint Day
#	create_character = {
#		location = root.location
#		gender = male
#		age = 0.1
#		trait = education_martial_4
#		#trait = devoted
#		faith = root.faith
#		culture = root.culture
#		learning = { 10 12 }
#		save_scope_as = saint_day_holder
#	}
#
#	faith = {
#		add_to_variable_list = {
#			name = faith_saint_day_dummy_chars
#			target = scope:saint_day_holder
#		}
#	}
#
#	scope:saint_day_holder = {
#		#get_title = title:e_hre
#		add_to_variable_list = {
#			name = saint_day_saint
#			target = scope:new_saint
#		}
#		create_story = story_saint_day
#	}
#}
#
#saint_day_effect = {
#	if = {
#		limit = {
#			faith:catholic = {
#				any_faith_ruler = {
#					any_realm_county = {
#						has_variable_list = faith_saints_and_capital
#						save_temporary_scope_as = saintlocationtemp
#					}
#				}
#			}
#		}
#		scope:saintlocationtemp = {
#			save_scope_as = saintlocation
#		}
#	}
#	scope:saintlocation = {
#		holder = {
#			add_gold = 100
#		}
#		random_in_list = {
#			variable = faith_saints_and_capital
#			save_scope_as = localsaint
#		}
#	}
#
#	create_character = {
#		location = root.location
#		gender = male
#		age = 0.0
#		trait = education_martial_4
#		#trait = devoted
#		faith = root.faith
#		culture = root.culture
#		learning = { 10 12 }
#		save_scope_as = saint_day_holder
#	}
#
#	scope:saint_day_holder = {
#		#add_gold = 10
#		faith = {
#			add_to_variable_list = {
#				name = faith_saint_day_dummy_chars
#				target = scope:saint_day_holder
#			}
#		}
#		set_variable = {
#			name = TCT_saint_day_saint
#			value = scope:localsaint
#		}
#	}
#
#	faith = {
#
#	}
#
#	global_var:TCT_saint_day_dummychar = {
#		add_gold = 10
#		add_prestige = 10
#		create_story = story_saint_day
#	}
#}
#
#become_saint_capital = {
#	save_scope_as = new_saint_capital
#}
#
#remove_saint = {
#	save_scope_as = remove_saint # Good work on avoiding ROOT
#	faith = {
#		remove_list_variable = {
#			name = faith_saints
#			target = scope:remove_saint
#		}
#	}
#}
#
#add_qa_effect = {
#	set_global_variable = qa_testing
#}

# #set_up_saint_sites_for_selection_effect = {
# 	if = {
# 		limit = { NOT = { exists = scope:has_set_up_saint_sites } }
# 		save_temporary_scope_as = pilgrim
		
# 		random_in_list = {
# 			variable = faith_capital

# 			if = {
# 				limit = {
# 					NOT = { exists = scope:saint_site_1 }
# 				}
# 				save_scope_as = saint_site_1
# 			}

# 			else_if = {
# 				limit = {
# 					NOT = { exists = scope:saint_site_2 }
# 				}
# 				save_scope_as = saint_site_2
# 			}

# 			else_if = {
# 				limit = {
# 					NOT = { exists = scope:saint_site_7 }
# 				}
# 				save_scope_as = saint_site_3
# 			}

# 			else_if = {
# 				limit = {
# 					NOT = { exists = scope:saint_site_7 }
# 				}
# 				save_scope_as = saint_site_4
# 			}

# 			else_if = {
# 				limit = {
# 					NOT = { exists = scope:saint_site_7 }
# 				}
# 				save_scope_as = saint_site_5
# 			}

# 			else_if = {
# 				limit = {
# 					NOT = { exists = scope:saint_site_7 }
# 				}
# 				save_scope_as = saint_site_6
# 			}

# 			else_if = {
# 				limit = {
# 					NOT = { exists = scope:saint_site_7 }
# 				}
# 				save_scope_as = saint_site_7
# 			}

# 			else_if = {
# 				limit = {
# 					NOT = { exists = scope:saint_site_8 }
# 				}
# 				save_scope_as = saint_site_8
# 			}

# 			else_if = {
# 				limit = {
# 					NOT = { exists = scope:saint_site_9 }
# 				}
# 				save_scope_as = saint_site_9
# 			}
# 			else = {
# 				debug_log = "Holy Site failed to get an assigned scope slot!"
# 				debug_log_scopes = yes
# 			}
# 		}	
# 		save_temporary_scope_value_as = {
# 			name = has_set_up_pilgrimage_sites
# 			value = yes
# 		}
# 	}
# 	# Debug checks:
# 	if = {
# 		limit = { NOT = { exists = scope:holy_site_1 } }
# 		debug_log = "No holy sites found in faith! (Except possibly mecca)"
# 		root.faith = {
# 			save_scope_as = current_faith
# 		}
# 		debug_log_scopes = yes
# 	}
# #}

#set_up_saint_sites_for_selection_effect = {	
#	random_province = {
#		limit = {
#			has_province_modifier = saintly_tomb
#			NOT = { exists = scope:saint_site_1 }
#		}
#		save_scope_as = saint_site_1
#	}
#}

# saint_site_selection_event_option_effect = {
# 	# HOLY_SITE = holy_site
# 	hidden_effect = {
# 		set_variable = {
# 			name = pilgrimage_cooldown_timer
# 			years = pilgrimage_cooldown_year_amount
# 		}
# 	}

# 	scope:saint_site_1 = {
# 		spawn_activity = {
# 			owner = root
# 			type = activity_pilgrimage
# 		}
# 	}
# 	if = {
# 		limit = { is_ai = no }
# 		calculate_pilgrimage_distance_effect = {
# 			PILGRIM = root
# 			HOLY_SITE = scope:saint_site_1
# 		}
# 	}
# }

pledge_ghw_piety_gain_effect = {
	if = {
		limit = { highest_held_title_tier = 5 }
		add_piety = 150
	}
	if = {
		limit = { highest_held_title_tier = 4 }
		add_piety = 120
	}
	if = {
		limit = { highest_held_title_tier = 3 }
		add_piety = 90
	}
	if = {
		limit = { highest_held_title_tier = 2 }
		add_piety = 60
	}
	if = {
		limit = { highest_held_title_tier = 1 }
		add_piety = 30
	}
	faith = {
		if = {
			limit = {
				exists = religious_head
				exists = great_holy_war
				religious_head = {
					has_title = title:k_papal_state
					NOT = { exists = var:ChangedCrusadeLeader }
				}
				exists = title:d_captain_general_church.holder
			}
			religious_head = {
				set_variable = {
					name = ChangedCrusadeLeader
					value = yes
					years = 30
				}
			}
			great_holy_war = {
				set_war_declarer = title:d_captain_general_church.holder
				if = {
					limit = {
						NOT = { has_pledged_attacker = title:d_captain_general_church.holder }
					}
					pledge_attacker = title:d_captain_general_church.holder
				}
			}
		}
	}
}

#testingtest = {
#	save_scope_as = persontoscope
#    scope:persontoscope.capital_county = {
#        save_scope_as = scoped_capital
#    }
#    scope:scoped_capital.county ={
#        add_to_variable_list = {
#            name = characterscopedandcountyscoped
#            target = scope:persontoscope
#        }
#    }
#}
#
#testinglist = {
#	every_in_list = { variable = characterscopedandcountyscoped add_trait = hashishiyah }
#}