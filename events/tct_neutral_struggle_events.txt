namespace = tct_neutral_struggle

##################################################
# MAINTENANCE EVENTS

##################################################
# Activate Passing of Time
# by Ewan Cowhig Croft
# 0001 - 0010
##################################################

tct_neutral_struggle.0001 = {
	hidden = yes
	scope = struggle

	immediate = {
		## # Yearly drift every year that the Pope and Emperor dislike eachother.
		if = {
			limit = {
				title:e_hre.holder = {
					any_character_struggle = { phase_has_catalyst = tct_papal_hre_opinions }
					opinion = {
						target = title:k_papal_state.holder
						value <= 0
					}
				}
				title:k_papal_state.holder = {
					opinion = {
						target = title:e_hre.holder
						value <= 0
					}
				}
			}
			title:e_hre.holder = {
				every_character_struggle = {
					activate_struggle_catalyst = {
						catalyst = tct_papal_hre_opinions
						character = title:e_hre.holder
					}
				}
			}
		}

		# Finally, queue the event up again for a year hence.
		trigger_event = {
			id = tct_neutral_struggle.0001
			years = 1
		}
	}
}

#for the emperor
tct_neutral_struggle.0002 = {
	type = character_event
	title = tct_neutral_struggle.0002.t
	desc = tct_neutral_struggle.0002.desc

	theme = realm
	override_background = {
		reference = farmland
	}
	left_portrait = {
		character = root
		animation = thinking
	}
	right_portrait = {
		character = title:d_angria.holder
		animation = anger
	}

	immediate = {
		culture:franconian = {
			change_cultural_acceptance = {
				target = culture:saxon
				value = -5
				desc = cultural_acceptance_historical_relations
			}
		}
		title:d_angria.holder = {
			add_opinion = {
				target = title:e_hre.holder
				modifier = insulted_opinion
				opinion = -50
			}
		}
		hidden_effect = {
			title:d_bavaria.holder = {
				add_opinion = {
					target = title:e_hre.holder
					modifier = insulted_opinion
					opinion = -50
				}
			}
		}
	}

	option = {
		name = tct_neutral_struggle.0002.a

		title:d_angria.holder = {
			trigger_event = tct_neutral_struggle.0003
		}
	}
}

tct_neutral_struggle.0003 = {
	type = character_event
	title = tct_neutral_struggle.0003.t
	desc = tct_neutral_struggle.0003.desc

	theme = realm

	override_background = {
		reference = farmland
	}
	left_portrait = {
		character = title:e_hre.holder
		animation = drink_goblet
	}
	right_portrait = {
		character = title:d_angria.holder
		animation = anger
	}

	option = {
		name = tct_neutral_struggle.0003.a

		show_as_tooltip = {
			culture:franconian = {
				change_cultural_acceptance = {
					target = culture:saxon
					value = -5
					desc = cultural_acceptance_historical_relations
				}
			}
			title:d_angria.holder = {
				add_opinion = {
					target = title:e_hre.holder
					modifier = insulted_opinion
					opinion = -50
				}
			}
			hidden_effect = {
				title:d_bavaria.holder = {
					add_opinion = {
						target = title:e_hre.holder
						modifier = insulted_opinion
						opinion = -50
					}
				}
			}
		}
	}
}

# The Scholarly Vassal requests lesser obligations
liege_vassal_dynamics.0001 = {
	type = character_event
	title = liege_vassal_dynamics.0001.t
	desc = liege_vassal_dynamics.0001.d
	theme = intrigue
	left_portrait = root
	right_portrait ?= liege

	trigger = {
		learning = 15
		NOT = { is_councillor = yes }
		vassal_contract_obligation_level:feudal_government_taxes = feudal_tax_normal
	}

	immediate = {
		save_scope_as = vassal
	}

	option = {
		name = liege_vassal_dynamics.0001.a

		liege ?= {
			trigger_event = liege_vassal_dynamics.0002
		}
	}
}

# Liege's Response
liege_vassal_dynamics.0002 = {
	type = character_event
	title = liege_vassal_dynamics.0002.t
	desc = liege_vassal_dynamics.0002.d
	theme = intrigue
	left_portrait = root
	right_portrait = vassal

	option = {
		name = liege_vassal_dynamics.0002.a
		add_opinion = { target = scope:vassal modifier = honored_opinion value = 40 }
		vassal_contract_set_obligation_level = { type = feudal_government_taxes level = feudal_tax_low }
	}
	option = {
		name = liege_vassal_dynamics.0002.b
		add_opinion = { target = scope:vassal modifier = insult_opinion value = -30 }
	}
}